import{j as e,a6 as v,aE as p,a7 as g,Q as M,Z as G,G as H,V as X,a1 as Z,a4 as ae,a3 as Q,a5 as ie,S as J,E,y as ee,D as C,T as le,ab as ce,as as de}from"./mui-core-B5jWrZut.js";import{S as te,a as ne,C as ue,O as xe,f as he,g as pe,h as ge,i as me,j as je}from"./mui-icons-Clbt9NnC.js";import{a as $,r as a}from"./react-vendor-3C0tOofb.js";import{i as fe,a as ve,b as Ce,c as be}from"./fullcalendar-plugins-DeC8k6NQ.js";import{a_ as ye}from"./fullcalendar-core-DORclIya.js";import{g as se,u as Se,a as Y,f as B,C as we,d as Ee,U as ke,b as De}from"./index-DBrrj3tO.js";import"./date-utils-BirqDsiu.js";import"./mui-pickers-Bg_m1Udz.js";import"./utils-Bb18XtNI.js";const Te=()=>e.jsx(M,{sx:{p:2,mb:3},children:e.jsxs(v,{spacing:2,children:[e.jsxs(v,{direction:"row",spacing:2,children:[e.jsx(p,{variant:"rounded",sx:{flexGrow:3},height:56}),e.jsx(p,{variant:"rounded",sx:{flexGrow:1},height:56})]}),e.jsxs(v,{direction:"row",spacing:2,children:[e.jsx(p,{variant:"rounded",width:"100%",height:56}),e.jsx(p,{variant:"rounded",width:"100%",height:56})]}),e.jsxs(g,{sx:{px:1},children:[e.jsx(p,{variant:"text",height:24,width:"15%",sx:{mb:2}}),e.jsx(p,{variant:"rounded",height:24})]}),e.jsx(G,{}),e.jsxs(v,{direction:"row",spacing:2,justifyContent:"space-between",children:[e.jsx(p,{variant:"rounded",width:150,height:36}),e.jsxs(v,{direction:"row",spacing:2,children:[e.jsx(p,{variant:"rounded",width:120,height:36}),e.jsx(p,{variant:"rounded",width:100,height:36}),e.jsx(p,{variant:"rounded",width:100,height:36})]})]})]})}),Pe=()=>e.jsxs(M,{sx:{p:2},children:[e.jsx(p,{variant:"rounded",height:50,sx:{mb:1}}),e.jsx(g,{sx:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:1},children:[...Array(35)].map((o,s)=>e.jsx(p,{variant:"rounded",height:100},s))})]});function Ie({isMobile:t}){return t?e.jsxs(v,{spacing:2,children:[e.jsx(p,{variant:"rounded",height:56}),e.jsx(p,{variant:"rounded",height:"75vh"})]}):e.jsxs(g,{children:[e.jsx(Te,{}),e.jsx(Pe,{})]})}const Oe=$.memo(Ie);function _e(t,n,o){const[s,c]=a.useState(t),[d,r]=a.useState(!1),[m,u]=a.useState(!1);a.useEffect(()=>{c(t),r(!1)},[t]);const x=a.useCallback(D=>{c(D),r(!0)},[]),j=a.useCallback(()=>{n(s),r(!1),o()},[s,n,o]),k=a.useCallback(()=>{d?u(!0):o()},[d,o]),y=a.useCallback(()=>{u(!1),o()},[o]),i=a.useCallback(()=>{u(!1)},[]);return{noteText:s,isDirty:d,isUnsavedChangesDialogOpen:m,handleNoteChange:x,handleSave:j,handleClose:k,handleConfirmClose:y,closeUnsavedDialog:i}}function We({category:t}){const n=H(),o=a.useMemo(()=>se(t,n.palette.mode),[t,n.palette.mode]);return e.jsx(X,{label:t,size:"small",sx:{backgroundColor:o,color:n.palette.getContrastText(o),fontWeight:"bold"}})}const oe=$.memo(We);function Fe({open:t,onClose:n,onConfirm:o,eventName:s}){return e.jsxs(Z,{open:t,onClose:n,disableRestoreFocus:!0,children:[e.jsx(ae,{children:"Confirm Deletion"}),e.jsx(Q,{children:e.jsxs(ie,{children:['Are you sure you want to delete the event "',s,'"? This action cannot be undone.']})}),e.jsxs(J,{children:[e.jsx(E,{onClick:n,children:"Cancel"}),e.jsx(E,{onClick:o,color:"error",variant:"contained",children:"Delete"})]})]})}function Le({start:t,end:n}){const o=H(),{status:s,displayTime:c}=Se(t,n),d=a.useMemo(()=>({active:{label:"Active",color:o.palette.success.main},upcoming:{label:"Upcoming",color:o.palette.warning.main},finished:{label:"Finished",color:o.palette.text.secondary}}),[o]);if(!s)return null;const r=d[s];return e.jsx(g,{sx:{backgroundColor:r.color,color:o.palette.getContrastText(r.color),borderRadius:"4px",px:1.5,py:.5,fontSize:"0.875rem",fontWeight:"bold",whiteSpace:"nowrap"},children:s==="finished"?r.label:`${r.label} (${c})`})}const re=$.memo(Le);function U({title:t,children:n}){return e.jsxs(v,{spacing:1.5,children:[e.jsx(C,{variant:"h6",component:"h3",fontWeight:"bold",children:t}),n,e.jsx(G,{sx:{pt:1}})]})}const Ae=({items:t})=>e.jsx(g,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.map(n=>e.jsx(X,{label:n},n))}),q={features:"Featured Pokémon",spawns:"Wild Encounters",raids:"Raids",eggs:"Eggs",shiny:"Shiny Debuts",shadow:"New Shadow Pokémon",moves:"Pokémon with Special Moves"};function Re(t){return t in q?q[t]:t.split("_").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}function Me({event:t,onClose:n,savedEventIds:o,onToggleSaveEvent:s,onDeleteEvent:c,onEditEvent:d,onUpdateNote:r,eventNotes:m,showToast:u}){const{settings:x}=Y(),{hour12:j}=x,[k,y]=a.useState(!1),i=a.useMemo(()=>t?{...t.extendedProps,id:t.extendedProps.article_url,title:t.title,isCustomEvent:t.extendedProps.category===we,isSaved:o.includes(t.extendedProps.article_url),start:B(t.start,j),end:t.end?B(t.end,j):null}:null,[t,o,j]),D=a.useCallback(f=>{i&&(r(i.id,f),u("Note saved successfully!","success"))},[i,r,u]),{noteText:T,isDirty:P,isUnsavedChangesDialogOpen:I,handleNoteChange:O,handleSave:N,handleClose:S,handleConfirmClose:L,closeUnsavedDialog:K}=_e(i&&m[i.id]||"",D,n),_=a.useCallback(()=>{i&&(c(i.id),y(!1),n())},[i,c,n]);if(!t||!i)return null;const{id:z,title:A,banner_url:V,isCustomEvent:R,isSaved:W}=i;return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{open:!0,onClose:S,maxWidth:"sm",fullWidth:!0,disableRestoreFocus:!0,PaperProps:{sx:{borderRadius:4}},children:[e.jsxs(Q,{sx:{p:0,position:"relative"},children:[e.jsx(ee,{"aria-label":W?"Unsave event":"Save event",onClick:()=>s(z),sx:{position:"absolute",top:8,right:8,backgroundColor:"rgba(0, 0, 0, 0.4)",color:"white","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.6)"},zIndex:2},children:W?e.jsx(te,{}):e.jsx(ne,{})}),e.jsx(g,{component:"img",src:V,alt:`${A} banner`,sx:{width:"100%",aspectRatio:"16 / 9",objectFit:"cover"}}),e.jsxs(g,{sx:{p:3,position:"relative",zIndex:1,backgroundColor:"background.paper"},children:[e.jsxs(v,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:2,flexWrap:"wrap",gap:1},children:[e.jsx(oe,{category:i.category}),e.jsx(re,{start:t.start,end:t.end})]}),e.jsx(C,{variant:"h5",component:"h2",gutterBottom:!0,sx:{fontWeight:"bold"},children:A}),e.jsxs(v,{direction:"row",spacing:1.5,alignItems:"center",sx:{mb:2},children:[e.jsx(ue,{color:"action"}),e.jsxs(C,{variant:"body1",children:[i.start," - ",i.end]})]}),e.jsx(G,{sx:{my:2}}),e.jsxs(v,{spacing:3,children:[i.description&&e.jsx(U,{title:"Description",children:e.jsx(C,{variant:"body1",children:i.description})}),i.bonuses&&i.bonuses.length>0&&e.jsx(U,{title:"Event Bonuses",children:e.jsx(v,{spacing:1,children:i.bonuses.map(f=>e.jsxs(C,{variant:"body1",children:["• ",f]},f))})}),Object.entries(i).filter(([f,F])=>!["category","article_url","banner_url","description","bonuses","id","title","isCustomEvent","isSaved","start","end"].includes(f)&&Array.isArray(F)&&F.length>0).map(([f,F])=>e.jsx(U,{title:Re(f),children:e.jsx(Ae,{items:F})},f)),e.jsx(U,{title:"Notes",children:e.jsx(le,{fullWidth:!0,multiline:!0,rows:4,variant:"outlined",placeholder:"Add your personal notes here...",value:T,onChange:f=>O(f.target.value)})})]})]})]}),e.jsxs(J,{sx:{p:2,flexDirection:{xs:"column-reverse",sm:"row"},justifyContent:"space-between",alignItems:"center",gap:2},children:[e.jsxs(v,{direction:"row",gap:1,flexWrap:"wrap",justifyContent:{xs:"center",sm:"flex-start"},children:[!R&&e.jsx(E,{component:ce,href:z,target:"_blank",rel:"noopener noreferrer",variant:"contained",endIcon:e.jsx(xe,{}),children:"Learn More"}),e.jsx(E,{variant:"outlined",startIcon:e.jsx(he,{}),onClick:()=>Ee(t),children:"Add to Calendar"})]}),e.jsxs(v,{direction:"row",gap:1,flexWrap:"wrap",justifyContent:{xs:"center",sm:"flex-end"},children:[R&&e.jsxs(e.Fragment,{children:[e.jsx(E,{onClick:()=>d(t),startIcon:e.jsx(pe,{}),children:"Edit"}),e.jsx(E,{onClick:()=>y(!0),color:"error",startIcon:e.jsx(ge,{}),children:"Delete"})]}),e.jsx(E,{variant:"contained",onClick:N,disabled:!P,children:"Save"}),e.jsx(E,{onClick:S,children:"Close"})]})]})]}),e.jsx(Fe,{open:k,onClose:()=>y(!1),onConfirm:_,eventName:A}),e.jsx(ke,{open:I,onClose:K,onConfirm:L})]})}function Ne({open:t,id:n,mousePosition:o,event:s,onClose:c}){const{settings:d}=Y(),{hour12:r}=d,m=a.useMemo(()=>s?.start?B(s.start,r):null,[s?.start,r]),u=a.useMemo(()=>s?.end?B(s.end,r):null,[s?.end,r]);return s?e.jsx(de,{id:n,open:t,anchorReference:"anchorPosition",anchorPosition:o?{top:o.top-10,left:o.left}:void 0,onClose:c,sx:{pointerEvents:"none"},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},disableRestoreFocus:!0,disableScrollLock:!0,container:document.body,slotProps:{paper:{sx:x=>({backgroundColor:x.palette.background.paper,boxShadow:x.shadows[8],borderRadius:2,maxWidth:"300px",p:0,overflow:"hidden",border:`1px solid ${x.palette.divider}`})}},children:e.jsxs(g,{sx:{p:2,display:"flex",flexDirection:"column",gap:1},children:[e.jsx(C,{variant:"h6",component:"h3",sx:{fontWeight:"bold",lineHeight:1.3},children:s.title}),e.jsx(G,{sx:{my:.5}}),e.jsxs(g,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:1},children:[e.jsx(oe,{category:s.extendedProps.category}),e.jsx(re,{start:s.start,end:s.end})]}),s.start&&e.jsxs(C,{variant:"body2",color:"text.secondary",children:[e.jsx(g,{component:"span",sx:{fontWeight:"bold"},children:"Start:"})," ",m]}),s.end&&e.jsxs(C,{variant:"body2",color:"text.secondary",children:[e.jsx(g,{component:"span",sx:{fontWeight:"bold"},children:"End:"})," ",u]})]})}):null}const ze=$.memo(function({eventInfo:n,isSaved:o,onToggleSave:s,onMouseEnter:c,onMouseLeave:d}){const r=H(),{category:m,article_url:u}=n.event.extendedProps,x=se(m,r.palette.mode);return e.jsxs(g,{sx:{backgroundColor:x,color:r.palette.getContrastText(x),borderRadius:"4px",overflow:"hidden",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",border:`1px solid ${r.palette.divider}`,boxSizing:"border-box",boxShadow:r.shadows[1],transition:"box-shadow 0.15s ease-in-out","&:hover":{boxShadow:r.shadows[4]}},onMouseEnter:j=>c(j,n.event),onMouseLeave:d,children:[e.jsxs(g,{sx:{p:"2px 8px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e.jsx("b",{children:n.timeText})," ",e.jsx("i",{children:n.event.title})]}),e.jsx(ee,{size:"small",onClick:j=>{j.stopPropagation(),s(u)},sx:{color:"inherit"},children:o?e.jsx(te,{fontSize:"inherit"}):e.jsx(ne,{fontSize:"inherit"})})]})});function Ue({events:t,isMobile:n,savedEventIds:o,filterStartDate:s,filterEndDate:c,selectedEvent:d,onSelectEvent:r,onToggleSaveEvent:m,onViewChange:u,onDeleteEvent:x,onUpdateNote:j,eventNotes:k,onEditEvent:y,onDateSelect:i,showToast:D}){const T=a.useRef(null),{settings:P}=Y(),{firstDay:I,hour12:O,timezone:N}=P,[S,L]=a.useState({event:null,position:null});a.useEffect(()=>{const l=setTimeout(()=>{T.current?.getApi().changeView(n?"listWeek":"dayGridMonth")},0);return()=>clearTimeout(l)},[n]);const K={hour:n||O?"numeric":"2-digit",minute:n?void 0:"2-digit",meridiem:n?"short":O},_=a.useCallback(l=>{const h=l.extendedProps.article_url;return t.find(w=>w.extendedProps.article_url===h)||null},[t]),z=a.useCallback(l=>{r(_(l.event))},[_,r]),A=a.useCallback(()=>{r(null)},[r]),V=a.useCallback(l=>{const{start:h,end:w}=l,b=new Date(w.getTime()-1);if(s&&c&&h.toDateString()===s.toDateString()&&b.toDateString()===c.toDateString()){i({start:null,end:null}),T.current?.getApi().unselect();return}i({start:h,end:b})},[s,c,i]),R=a.useCallback((l,h)=>{const w=_(h);L({event:w,position:{top:l.clientY,left:l.clientX}})},[_]),W=a.useCallback(()=>{L({event:null,position:null})},[]),f=a.useCallback(l=>{S.event&&L(h=>({...h,position:{top:l.clientY,left:l.clientX}}))},[S.event]),F=a.useCallback(l=>{const h=l.event.extendedProps.article_url,w=o.includes(h);return e.jsx(ze,{eventInfo:l,isSaved:w,onToggleSave:m,onMouseEnter:R,onMouseLeave:W})},[o,m,R,W]);return t.length===0?e.jsxs(M,{elevation:3,sx:{p:{xs:2,md:4},display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:[e.jsx(me,{sx:{fontSize:60,color:"text.secondary",mb:2}}),e.jsx(C,{variant:"h6",component:"p",color:"text.secondary",children:"No Events Found"}),e.jsx(C,{color:"text.secondary",children:"Try adjusting your filters or creating a new custom event."})]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{elevation:3,sx:{p:{xs:1,md:2}},onMouseMove:f,children:e.jsx(ye,{ref:T,plugins:[fe,ve,Ce,be],headerToolbar:n?{left:"prev,next",center:"title",right:"listWeek,dayGridMonth"}:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},initialView:"dayGridMonth",events:t,eventClick:z,eventContent:F,height:n?"75vh":"auto",aspectRatio:n?1.2:1.75,eventBackgroundColor:"transparent",eventBorderColor:"transparent",datesSet:l=>u(l.view.type),titleFormat:n?{month:"short",year:"numeric"}:{month:"long",year:"numeric"},firstDay:I,selectable:!0,select:V,unselectAuto:!1,eventTimeFormat:K,timeZone:N,eventDidMount:l=>{l.el.setAttribute("data-event-id",l.event.extendedProps.article_url)},eventMouseEnter:l=>{const h=l.event.extendedProps.article_url;document.querySelectorAll(`[data-event-id="${h}"]`).forEach(b=>{b.style.filter="brightness(1.3)",b.style.boxShadow="0 0 8px rgba(0, 0, 0, 0.5)",b.style.zIndex="10"})},eventMouseLeave:l=>{const h=l.event.extendedProps.article_url;document.querySelectorAll(`[data-event-id="${h}"]`).forEach(b=>{b.style.filter="",b.style.boxShadow="",b.style.zIndex=""})}},N)}),e.jsx(Ne,{open:!!S.event,id:S.event?"mouse-over-popover":void 0,mousePosition:S.position,event:S.event,onClose:W}),e.jsx(Me,{eventNotes:k,onUpdateNote:j,event:d,onClose:A,savedEventIds:o,onToggleSaveEvent:m,onDeleteEvent:x,onEditEvent:y,showToast:D})]})}function Ze(t){const{isLoading:n,isMobile:o,onEditEvent:s,onDeleteEvent:c,showToast:d}=t,{error:r,filteredEvents:m,savedEventIds:u,eventNotes:x,selectedEvent:j,setSelectedEvent:k,handleToggleSaveEvent:y,updateNote:i,setFilters:D,setCurrentView:T,filters:P}=De();return n?e.jsx(Oe,{isMobile:o}):r?e.jsxs(M,{elevation:3,sx:{p:{xs:2,md:4},display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"60vh",textAlign:"center"},children:[e.jsx(je,{sx:{fontSize:60,color:"error.main",mb:2}}),e.jsx(C,{variant:"h5",component:"p",color:"error.main",gutterBottom:!0,children:"Failed to Load Events"}),e.jsx(C,{color:"text.secondary",children:r})]}):e.jsx(g,{children:e.jsx(Ue,{events:m,isMobile:o,savedEventIds:u,filterStartDate:P.startDate,filterEndDate:P.endDate,selectedEvent:j,onSelectEvent:k,onToggleSaveEvent:y,onViewChange:T,onUpdateNote:i,eventNotes:x,onDeleteEvent:c,onEditEvent:s,onDateSelect:I=>D(O=>({...O,startDate:I.start,endDate:I.end})),showToast:d})})}export{Ze as default};
