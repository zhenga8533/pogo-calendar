import{j as e,a6 as c,aH as j,a7 as u,Q as A,Z as Q,G as H,V as q,a1 as J,a4 as le,a3 as ee,a5 as ce,S as te,E as w,y as ne,D as h,T as de,ab as xe,av as he}from"./mui-core-bcLv4slq.js";import{S as re,a as se,j as ue,k as oe,O as pe,l as ge,m as me,n as je,C as fe,o as ve,g as Ce}from"./mui-icons-Bo2hajml.js";import{a as U,r as a}from"./react-vendor-COZ0iPm4.js";import{i as be,a as Se,b as ye,c as we}from"./fullcalendar-plugins-CvxyWIf5.js";import{a_ as ke}from"./fullcalendar-core-DOHL61tT.js";import{g as ie,u as Ee,a as K,f as B,C as Te,d as De,U as We,b as Oe}from"./index-CSqie3sd.js";import"./date-utils-BirqDsiu.js";import"./mui-pickers-zOORXj_E.js";import"./utils-DiIHWmkM.js";const ze=()=>e.jsx(A,{sx:{p:2,mb:3},children:e.jsxs(c,{spacing:2,children:[e.jsxs(c,{direction:"row",spacing:2,children:[e.jsx(j,{variant:"rounded",sx:{flexGrow:3},height:56}),e.jsx(j,{variant:"rounded",sx:{flexGrow:1},height:56})]}),e.jsxs(c,{direction:"row",spacing:2,children:[e.jsx(j,{variant:"rounded",width:"100%",height:56}),e.jsx(j,{variant:"rounded",width:"100%",height:56})]}),e.jsxs(u,{sx:{px:1},children:[e.jsx(j,{variant:"text",height:24,width:"15%",sx:{mb:2}}),e.jsx(j,{variant:"rounded",height:24})]}),e.jsx(Q,{}),e.jsxs(c,{direction:"row",spacing:2,justifyContent:"space-between",children:[e.jsx(j,{variant:"rounded",width:150,height:36}),e.jsxs(c,{direction:"row",spacing:2,children:[e.jsx(j,{variant:"rounded",width:120,height:36}),e.jsx(j,{variant:"rounded",width:100,height:36}),e.jsx(j,{variant:"rounded",width:100,height:36})]})]})]})}),Ie=()=>e.jsxs(A,{sx:{p:2},children:[e.jsx(j,{variant:"rounded",height:50,sx:{mb:1}}),e.jsx(u,{sx:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:1},children:[...Array(35)].map((r,s)=>e.jsx(j,{variant:"rounded",height:100},s))})]});function Pe({isMobile:t}){return t?e.jsxs(c,{spacing:2,children:[e.jsx(j,{variant:"rounded",height:56}),e.jsx(j,{variant:"rounded",height:"75vh"})]}):e.jsxs(u,{children:[e.jsx(ze,{}),e.jsx(Ie,{})]})}const ae=U.memo(Pe);ae.displayName="CalendarSkeleton";function _e(t,n,r){const[s,x]=a.useState(t),[g,o]=a.useState(!1),[f,m]=a.useState(!1);a.useEffect(()=>{x(t),o(!1)},[t]);const p=a.useCallback(E=>{x(E),o(!0)},[]),v=a.useCallback(()=>{n(s),o(!1),r()},[s,n,r]),k=a.useCallback(()=>{g?m(!0):r()},[g,r]),b=a.useCallback(()=>{m(!1),r()},[r]),i=a.useCallback(()=>{m(!1)},[]);return{noteText:s,isDirty:g,isUnsavedChangesDialogOpen:f,handleNoteChange:p,handleSave:v,handleClose:k,handleConfirmClose:b,closeUnsavedDialog:i}}function Fe({category:t}){const n=H(),r=a.useMemo(()=>ie(t,n.palette.mode),[t,n.palette.mode]);return e.jsx(q,{label:t,size:"small",sx:{backgroundColor:r,color:n.palette.getContrastText(r),fontWeight:600,fontSize:"0.75rem",height:"24px",borderRadius:"6px"}})}const V=U.memo(Fe);V.displayName="CategoryTag";function Re({open:t,onClose:n,onConfirm:r,eventName:s}){return e.jsxs(J,{open:t,onClose:n,disableRestoreFocus:!0,children:[e.jsx(le,{children:"Confirm Deletion"}),e.jsx(ee,{children:e.jsxs(ce,{children:['Are you sure you want to delete the event "',s,'"? This action cannot be undone.']})}),e.jsxs(te,{children:[e.jsx(w,{onClick:n,children:"Cancel"}),e.jsx(w,{onClick:r,color:"error",variant:"contained",children:"Delete"})]})]})}function Ae({start:t,end:n}){const r=H(),{status:s,displayTime:x}=Ee(t,n),g=a.useMemo(()=>({active:{label:"Active",color:r.palette.success.main},upcoming:{label:"Upcoming",color:r.palette.warning.main},finished:{label:"Finished",color:r.palette.text.secondary}}),[r]);if(!s)return null;const o=g[s];return e.jsx(u,{sx:{backgroundColor:o.color,color:r.palette.getContrastText(o.color),borderRadius:"6px",px:1.5,py:.5,fontSize:"0.75rem",fontWeight:600,whiteSpace:"nowrap",height:"24px",display:"inline-flex",alignItems:"center"},children:s==="finished"?o.label:`${o.label} (${x})`})}const Y=U.memo(Ae);Y.displayName="EventStatusTag";function M({title:t,children:n,icon:r}){return e.jsxs(c,{spacing:1.5,children:[e.jsxs(c,{direction:"row",spacing:1,alignItems:"center",children:[r,e.jsx(h,{variant:"h6",component:"h3",sx:{fontWeight:700,fontSize:"1rem",color:"text.primary"},children:t})]}),n]})}const Le=({items:t})=>e.jsx(u,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:t.map(n=>e.jsx(q,{label:n,size:"small",sx:{borderRadius:"8px",fontWeight:500,fontSize:"0.8125rem"}},n))}),X={features:"Featured Pokémon",spawns:"Wild Encounters",raids:"Raid Battles",eggs:"Egg Hatches",shiny:"Available Shinies",shadow:"Available Shadows",moves:"Special Moves"};function Ne(t){return t in X?X[t]:t.split("_").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}function Me({event:t,onClose:n,savedEventIds:r,onToggleSaveEvent:s,onDeleteEvent:x,onEditEvent:g,onUpdateNote:o,eventNotes:f,showToast:m}){const{settings:p}=K(),{hour12:v}=p,[k,b]=a.useState(!1),i=a.useMemo(()=>t?{...t.extendedProps,id:t.extendedProps.article_url,title:t.title,isCustomEvent:t.extendedProps.category===Te,isSaved:r.includes(t.extendedProps.article_url),start:B(t.start,v),end:t.end?B(t.end,v):null}:null,[t,r,v]),E=a.useCallback(d=>{i&&(o(i.id,d),m("Note saved successfully!","success"))},[i,o,m]),{noteText:T,isDirty:W,isUnsavedChangesDialogOpen:O,handleNoteChange:z,handleSave:L,handleClose:S,handleConfirmClose:_,closeUnsavedDialog:$}=_e(i&&f[i.id]||"",E,n),I=a.useCallback(()=>{i&&(x(i.id),b(!1),n())},[i,x,n]);if(!t||!i)return null;const{id:N,title:F,banner_url:G,isCustomEvent:R,isSaved:P}=i;return e.jsxs(e.Fragment,{children:[e.jsxs(J,{open:!0,onClose:S,maxWidth:"sm",fullWidth:!0,disableRestoreFocus:!0,slotProps:{paper:{sx:{borderRadius:3,boxShadow:d=>d.shadows[12]}}},children:[e.jsxs(ee,{sx:{p:0,position:"relative"},children:[e.jsx(ne,{"aria-label":P?"Unsave event":"Save event",onClick:()=>s(N),sx:{position:"absolute",top:8,right:8,backgroundColor:"rgba(0, 0, 0, 0.4)",color:"white","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.6)"},zIndex:2},children:P?e.jsx(re,{}):e.jsx(se,{})}),e.jsx(u,{component:"img",src:G,alt:`Event banner for ${F} - ${i.category} event`,sx:{width:"100%",aspectRatio:"16 / 9",objectFit:"cover",maxHeight:"280px"}}),e.jsx(u,{sx:d=>({borderBottom:`1px solid ${d.palette.divider}`,p:3,pb:2.5}),children:e.jsxs(c,{spacing:2,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:1,children:[e.jsx(V,{category:i.category}),e.jsx(Y,{start:t.start,end:t.end})]}),e.jsx(h,{variant:"h5",component:"h2",sx:{fontWeight:700,fontSize:"1.5rem",lineHeight:1.3},children:F}),e.jsxs(c,{spacing:1.5,children:[e.jsxs(c,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(ue,{sx:{fontSize:20,color:"primary.main"}}),e.jsxs(u,{children:[e.jsx(h,{variant:"caption",sx:{fontWeight:600,color:"text.secondary",textTransform:"uppercase",letterSpacing:.5,fontSize:"0.7rem",display:"block"},children:"Start Time"}),e.jsx(h,{variant:"body2",sx:{fontWeight:500,color:"text.primary"},children:i.start})]})]}),i.end&&e.jsxs(c,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(oe,{sx:{fontSize:20,color:"secondary.main"}}),e.jsxs(u,{children:[e.jsx(h,{variant:"caption",sx:{fontWeight:600,color:"text.secondary",textTransform:"uppercase",letterSpacing:.5,fontSize:"0.7rem",display:"block"},children:"End Time"}),e.jsx(h,{variant:"body2",sx:{fontWeight:500,color:"text.primary"},children:i.end})]})]})]})]})}),e.jsx(u,{sx:{p:3},children:e.jsxs(c,{spacing:3,divider:e.jsx(Q,{}),children:[i.description&&e.jsx(M,{title:"Description",children:e.jsx(c,{spacing:.75,children:i.description.split(`
`).map((d,y)=>{const l=d.trim();if(!l)return null;const C=l.startsWith("- ")?"• "+l.substring(2):l;return e.jsx(h,{variant:"body1",sx:{lineHeight:1.7},children:C},y)})})}),i.bonuses&&i.bonuses.length>0&&e.jsx(M,{title:"Event Bonuses",children:e.jsx(c,{spacing:.75,children:i.bonuses.map(d=>e.jsxs(h,{variant:"body2",sx:{lineHeight:1.6,pl:1},children:["• ",d]},d))})}),Object.entries(i).filter(([d,y])=>!["category","article_url","banner_url","description","bonuses","id","title","isCustomEvent","isSaved","start","end"].includes(d)&&Array.isArray(y)&&y.length>0).map(([d,y])=>e.jsx(M,{title:Ne(d),children:e.jsx(Le,{items:y})},d)),e.jsx(M,{title:"Notes",children:e.jsx(de,{fullWidth:!0,multiline:!0,rows:4,variant:"outlined",placeholder:"Add your personal notes here...",value:T,onChange:d=>z(d.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})})]})})]}),e.jsxs(te,{sx:{p:2,flexDirection:{xs:"column-reverse",sm:"row"},justifyContent:"space-between",alignItems:"center",gap:2},children:[e.jsxs(c,{direction:"row",gap:1,flexWrap:"wrap",justifyContent:{xs:"center",sm:"flex-start"},children:[!R&&e.jsx(w,{component:xe,href:N,target:"_blank",rel:"noopener noreferrer",variant:"contained",endIcon:e.jsx(pe,{}),children:"Learn More"}),e.jsx(w,{variant:"outlined",startIcon:e.jsx(ge,{}),onClick:()=>De(t,d=>m(d,"error")),children:"Add to Calendar"})]}),e.jsxs(c,{direction:"row",gap:1,flexWrap:"wrap",justifyContent:{xs:"center",sm:"flex-end"},children:[R&&e.jsxs(e.Fragment,{children:[e.jsx(w,{onClick:()=>g(t),startIcon:e.jsx(me,{}),children:"Edit"}),e.jsx(w,{onClick:()=>b(!0),color:"error",startIcon:e.jsx(je,{}),children:"Delete"})]}),e.jsx(w,{variant:"contained",onClick:L,disabled:!W,children:"Save"}),e.jsx(w,{onClick:S,children:"Close"})]})]})]}),e.jsx(Re,{open:k,onClose:()=>b(!1),onConfirm:I,eventName:F}),e.jsx(We,{open:O,onClose:$,onConfirm:_})]})}function Be({open:t,id:n,mousePosition:r,event:s,onClose:x}){const{settings:g}=K(),{hour12:o}=g,f=a.useMemo(()=>s?.start?B(s.start,o):null,[s?.start,o]),m=a.useMemo(()=>s?.end?B(s.end,o):null,[s?.end,o]);return s?e.jsxs(he,{id:n,open:t,anchorReference:"anchorPosition",anchorPosition:r?{top:r.top-10,left:r.left}:void 0,onClose:x,sx:{pointerEvents:"none"},anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"},disableRestoreFocus:!0,disableScrollLock:!0,container:document.body,slotProps:{paper:{sx:p=>({backgroundColor:p.palette.background.paper,boxShadow:p.shadows[12],borderRadius:3,maxWidth:"340px",p:0,overflow:"hidden",border:`1px solid ${p.palette.divider}`,backdropFilter:"blur(10px)"})}},children:[e.jsx(u,{sx:p=>({borderBottom:`1px solid ${p.palette.divider}`,p:2.5,pb:2}),children:e.jsxs(c,{spacing:1.5,children:[e.jsx(h,{variant:"h6",component:"h3",sx:{fontWeight:700,lineHeight:1.3,fontSize:"1.1rem"},children:s.title}),e.jsxs(c,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:[e.jsx(V,{category:s.extendedProps.category}),e.jsx(Y,{start:s.start,end:s.end})]})]})}),e.jsx(u,{sx:{p:2.5,pt:2},children:e.jsxs(c,{spacing:1.5,children:[s.start&&e.jsxs(c,{direction:"row",spacing:1.5,alignItems:"flex-start",children:[e.jsx(fe,{sx:{fontSize:20,color:"primary.main",mt:.25,flexShrink:0}}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsx(h,{variant:"caption",sx:{fontWeight:600,color:"text.secondary",textTransform:"uppercase",letterSpacing:.5,fontSize:"0.7rem"},children:"Start Time"}),e.jsx(h,{variant:"body2",sx:{fontWeight:500,color:"text.primary",mt:.25},children:f})]})]}),s.end&&e.jsxs(c,{direction:"row",spacing:1.5,alignItems:"flex-start",children:[e.jsx(oe,{sx:{fontSize:20,color:"secondary.main",mt:.25,flexShrink:0}}),e.jsxs(u,{sx:{flex:1,minWidth:0},children:[e.jsx(h,{variant:"caption",sx:{fontWeight:600,color:"text.secondary",textTransform:"uppercase",letterSpacing:.5,fontSize:"0.7rem"},children:"End Time"}),e.jsx(h,{variant:"body2",sx:{fontWeight:500,color:"text.primary",mt:.25},children:m})]})]})]})})]}):null}const Ue=U.memo(function({eventInfo:n,isSaved:r,onToggleSave:s,onMouseEnter:x,onMouseLeave:g}){const o=H(),{category:f,article_url:m}=n.event.extendedProps,p=ie(f,o.palette.mode);return e.jsxs(u,{sx:{backgroundColor:p,color:o.palette.getContrastText(p),borderRadius:"4px",overflow:"hidden",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",border:`1px solid ${o.palette.divider}`,boxSizing:"border-box",boxShadow:o.shadows[1],transition:"box-shadow 0.15s ease-in-out","&:hover":{boxShadow:o.shadows[4]}},onMouseEnter:v=>x(v,n.event),onMouseLeave:g,children:[e.jsxs(u,{sx:{p:"2px 8px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[e.jsx("b",{children:n.timeText})," ",e.jsx("i",{children:n.event.title})]}),e.jsx(ne,{size:"small",onClick:v=>{v.stopPropagation(),s(m)},sx:{color:"inherit"},children:r?e.jsx(re,{fontSize:"inherit"}):e.jsx(se,{fontSize:"inherit"})})]})});function $e({events:t,isMobile:n,savedEventIds:r,filterStartDate:s,filterEndDate:x,selectedEvent:g,onSelectEvent:o,onToggleSaveEvent:f,onViewChange:m,onDeleteEvent:p,onUpdateNote:v,eventNotes:k,onEditEvent:b,onDateSelect:i,showToast:E}){const T=a.useRef(null),{settings:W}=K(),{firstDay:O,hour12:z,timezone:L}=W,[S,_]=a.useState({event:null,position:null});a.useEffect(()=>{const l=setTimeout(()=>{T.current?.getApi().changeView(n?"listWeek":"dayGridMonth")},0);return()=>clearTimeout(l)},[n]);const $={hour:n||z?"numeric":"2-digit",minute:n?void 0:"2-digit",meridiem:n?"short":z},I=a.useCallback(l=>{const C=l.extendedProps.article_url;return t.find(D=>D.extendedProps.article_url===C)||null},[t]),N=a.useCallback(l=>{o(I(l.event))},[I,o]),F=a.useCallback(()=>{o(null)},[o]),G=a.useCallback(l=>{const{start:C,end:D}=l,Z=new Date(D.getTime()-1);if(s&&x&&C.toDateString()===s.toDateString()&&Z.toDateString()===x.toDateString()){i({start:null,end:null}),T.current?.getApi().unselect();return}i({start:C,end:Z})},[s,x,i]),R=a.useCallback((l,C)=>{const D=I(C);_({event:D,position:{top:l.clientY,left:l.clientX}})},[I]),P=a.useCallback(()=>{_({event:null,position:null})},[]),d=a.useCallback(l=>{S.event&&_(C=>({...C,position:{top:l.clientY,left:l.clientX}}))},[S.event]),y=a.useCallback(l=>{const C=l.event.extendedProps.article_url,D=r.includes(C);return e.jsx(Ue,{eventInfo:l,isSaved:D,onToggleSave:f,onMouseEnter:R,onMouseLeave:P})},[r,f,R,P]);return t.length===0?e.jsxs(A,{elevation:3,sx:{p:{xs:2,md:4},display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:[e.jsx(ve,{sx:{fontSize:60,color:"text.secondary",mb:2}}),e.jsx(h,{variant:"h6",component:"p",color:"text.secondary",children:"No Events Found"}),e.jsx(h,{color:"text.secondary",children:"Try adjusting your filters or creating a new custom event."})]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{elevation:3,sx:{p:{xs:1,md:2}},onMouseMove:d,children:e.jsx(ke,{ref:T,plugins:[be,Se,ye,we],headerToolbar:n?{left:"prev,next",center:"title",right:"listWeek,dayGridMonth"}:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},initialView:"dayGridMonth",events:t,eventClick:N,eventContent:y,height:n?"75vh":"auto",aspectRatio:n?1.2:1.75,eventBackgroundColor:"transparent",eventBorderColor:"transparent",datesSet:l=>m(l.view.type),titleFormat:n?{month:"short",year:"numeric"}:{month:"long",year:"numeric"},firstDay:O,selectable:!0,select:G,unselectAuto:!1,eventTimeFormat:$,timeZone:L,eventClassNames:l=>`event-${l.event.extendedProps.article_url.replace(/[^a-zA-Z0-9]/g,"_")}`},L)}),e.jsx(Be,{open:!!S.event,id:S.event?"mouse-over-popover":void 0,mousePosition:S.position,event:S.event,onClose:P}),e.jsx(Me,{eventNotes:k,onUpdateNote:v,event:g,onClose:F,savedEventIds:r,onToggleSaveEvent:f,onDeleteEvent:p,onEditEvent:b,showToast:E})]})}function Je(t){const{isLoading:n,isMobile:r,onEditEvent:s,onDeleteEvent:x,showToast:g}=t,{error:o,filteredEvents:f,savedEventIds:m,eventNotes:p,selectedEvent:v,setSelectedEvent:k,handleToggleSaveEvent:b,updateNote:i,setFilters:E,setCurrentView:T,filters:W}=Oe();return n?e.jsx(ae,{isMobile:r}):o?e.jsxs(A,{elevation:0,sx:{p:4,textAlign:"center",backgroundColor:"background.paper",borderRadius:2},children:[e.jsx(Ce,{sx:{fontSize:64,color:"error.main",mb:2}}),e.jsx(h,{variant:"h5",color:"text.primary",gutterBottom:!0,children:"Failed to Load Events"}),e.jsx(h,{variant:"body2",color:"text.secondary",children:o})]}):e.jsx(u,{children:e.jsx($e,{events:f,isMobile:r,savedEventIds:m,filterStartDate:W.startDate,filterEndDate:W.endDate,selectedEvent:v,onSelectEvent:k,onToggleSaveEvent:b,onViewChange:T,onUpdateNote:i,eventNotes:p,onDeleteEvent:x,onEditEvent:s,onDateSelect:O=>E(z=>({...z,startDate:O.start,endDate:O.end})),showToast:g})})}export{Je as default};
