import{j as e,a7 as n,aG as C,a6 as w,D as c,V as d,ai as R,aj as S,ak as T,aI as u,ae as W}from"./mui-core-BM6OZ3Ae.js";import{E as v}from"./mui-icons-DRtSjZgt.js";import{a as D,r as g}from"./react-vendor-COZ0iPm4.js";import{u as I,D as P,a as E,P as z,c as L,S as A}from"./dataService-D6R8r1Ib.js";import"./index-BysE4DFC.js";import"./date-utils-BirqDsiu.js";import"./mui-pickers-BzuYHJMN.js";import"./utils-DiIHWmkM.js";function F({filters:r,onSetFilterOptions:h}){const{data:t,loading:f,error:x,refetch:j}=I(L,"Failed to load research task data. Please try again later.");g.useEffect(()=>{if(t){const a=Object.keys(t);h({categories:a})}},[t,h]);const p=g.useMemo(()=>{if(!t)return null;const a={};return Object.entries(t).forEach(([s,i])=>{if(r.selectedCategories.length>0&&!r.selectedCategories.includes(s))return;const o=i.filter(m=>{if(r.taskSearch&&!m.task.toLowerCase().includes(r.taskSearch.toLowerCase()))return!1;const k=m.rewards.some(l=>!(r.rewardTypes.length>0&&!r.rewardTypes.includes(l.type)||r.pokemonSearch&&l.type==="encounter"&&!l.name.toLowerCase().includes(r.pokemonSearch.toLowerCase())||r.shinyOnly&&!l.shiny_available));return r.rewardTypes.length>0||r.pokemonSearch||r.shinyOnly?k:!0});o.length>0&&(a[s]=o)}),a},[t,r]);if(f)return e.jsx(P,{itemCount:6,gridSize:{xs:12}});if(x||!t||!p)return e.jsx(E,{title:"Failed to Load Research Task Data",message:x||void 0,onRetry:j});const y=(a,s)=>e.jsxs(W,{sx:{display:"flex",alignItems:"center",p:2,backgroundColor:"background.default",minHeight:80},children:[e.jsx(n,{sx:{width:64,height:64,minWidth:64,display:"flex",alignItems:"center",justifyContent:"center",mr:2,backgroundColor:"background.paper",borderRadius:1,overflow:"hidden"},children:e.jsx(n,{component:"img",src:a.asset_url,alt:a.name,sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}})}),e.jsxs(n,{sx:{flexGrow:1,minWidth:0},children:[e.jsxs(c,{variant:"subtitle2",fontWeight:600,noWrap:!0,children:[a.name,a.quantity&&a.quantity>1&&` x${a.quantity}`]}),e.jsxs(n,{sx:{display:"flex",gap:.5,mt:.5,flexWrap:"wrap"},children:[e.jsx(d,{label:a.type==="encounter"?"Pokémon":"Item",size:"small",sx:{height:20,fontSize:"0.7rem",backgroundColor:a.type==="encounter"?"#4CAF50":"#2196F3",color:"#fff",fontWeight:600}}),a.shiny_available&&e.jsx(A,{})]})]})]},s),b=(a,s)=>e.jsxs(R,{sx:{mb:1,"&:before":{display:"none"},borderRadius:"12px !important",overflow:"hidden"},children:[e.jsx(S,{expandIcon:e.jsx(v,{}),sx:{backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover"}},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",width:"100%",pr:2},children:[e.jsx(c,{variant:"body1",fontWeight:600,sx:{flexGrow:1},children:a.task}),e.jsx(d,{label:`${a.rewards.length} Reward${a.rewards.length!==1?"s":""}`,size:"small",sx:{backgroundColor:"primary.main",color:"#fff",fontWeight:600}})]})}),e.jsx(T,{sx:{pt:2},children:e.jsx(u,{container:!0,spacing:2,children:a.rewards.map((i,o)=>e.jsx(u,{size:{xs:12,sm:6,md:4},children:y(i,o)},o))})})]},s);return e.jsxs(n,{sx:{py:4},children:[e.jsx(z,{title:"Research Tasks",description:"Current field research tasks and their rewards"}),e.jsx(C,{severity:"info",sx:{mb:3},children:"Field research tasks are obtained by spinning PokéStops. Complete tasks to earn rewards including Pokémon encounters, items, and Stardust."}),e.jsx(w,{spacing:3,children:Object.entries(p).map(([a,s])=>!s||s.length===0?null:e.jsxs(n,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(c,{variant:"h5",fontWeight:600,children:a}),e.jsx(d,{label:`${s.length} Task${s.length!==1?"s":""}`,size:"small",sx:{backgroundColor:"primary.main",color:"#fff",fontWeight:600}})]}),s.map((i,o)=>b(i,o))]},a))})]})}const V=D.memo(F);export{V as default};
